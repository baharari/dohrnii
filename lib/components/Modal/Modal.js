var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));var _objectWithoutProperties2=_interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties"));var _react=_interopRequireDefault(require("react"));var _reactNative=require("react-native");var _Text=_interopRequireDefault(require("../Text/Text"));var _providers=require("../../providers");var _theme=require("../../theme");var _styles=_interopRequireDefault(require("./styles"));var _types=require("./types");var _jsxRuntime=require("react/jsx-runtime");var _excluded=["opened","onClose","title","hideHeader","borderRadius","overlayColor","mode","position","overlayClose","style","bodyStyle","headerStyle","children"];var _this=this,_jsxFileName="/Users/limonagaci/Desktop/app/dohrnii/src/components/Modal/Modal.js";var Modal=function Modal(props){var _themeMode$colors;var _useTheme=(0,_providers.useTheme)(),themeMode=_useTheme.theme;var styles=(0,_styles.default)(themeMode);var merged=Object.assign({},_types.ModalDefaultProps,props);var opened=merged.opened,onClose=merged.onClose,title=merged.title,hideHeader=merged.hideHeader,borderRadius=merged.borderRadius,overlayColor=merged.overlayColor,mode=merged.mode,position=merged.position,overlayClose=merged.overlayClose,style=merged.style,bodyStyle=merged.bodyStyle,headerStyle=merged.headerStyle,children=merged.children,rest=(0,_objectWithoutProperties2.default)(merged,_excluded);var _Dimensions$get=_reactNative.Dimensions.get('window'),screenWidth=_Dimensions$get.width,screenHeight=_Dimensions$get.height;var overlayOpacity=_react.default.useRef(new _reactNative.Animated.Value(0)).current;var drawerTranslate=_react.default.useRef(new _reactNative.Animated.Value(0)).current;var _React$useState=_react.default.useState(false),_React$useState2=(0,_slicedToArray2.default)(_React$useState,2),visible=_React$useState2[0],setVisible=_React$useState2[1];var getInitialOffset=_react.default.useCallback(function(){switch(position){case'left':return{axis:'x',value:-screenWidth};case'right':return{axis:'x',value:screenWidth};case'top':return{axis:'y',value:-screenHeight};case'bottom':default:return{axis:'y',value:screenHeight};}},[position,screenWidth,screenHeight]);_react.default.useEffect(function(){if(mode==='drawer'){var _getInitialOffset=getInitialOffset(),value=_getInitialOffset.value;drawerTranslate.setValue(value);}else{drawerTranslate.setValue(0);}},[mode,getInitialOffset,drawerTranslate]);_react.default.useEffect(function(){if(opened){setVisible(true);overlayOpacity.setValue(0);_reactNative.Animated.timing(overlayOpacity,{toValue:1,duration:200,useNativeDriver:true}).start();if(mode==='drawer'){var _getInitialOffset2=getInitialOffset(),value=_getInitialOffset2.value;drawerTranslate.setValue(value);_reactNative.Animated.timing(drawerTranslate,{toValue:0,duration:220,useNativeDriver:true}).start();}}else{var animations=[_reactNative.Animated.timing(overlayOpacity,{toValue:0,duration:180,useNativeDriver:true})];if(mode==='drawer'){var _getInitialOffset3=getInitialOffset(),_value=_getInitialOffset3.value;animations.push(_reactNative.Animated.timing(drawerTranslate,{toValue:_value,duration:200,useNativeDriver:true}));}_reactNative.Animated.parallel(animations).start(function(){setVisible(false);});}},[opened,mode,getInitialOffset,overlayOpacity,drawerTranslate]);var resolvedOverlayColor=(0,_theme.processColorValue)(overlayColor||(themeMode==null||(_themeMode$colors=themeMode.colors)==null?void 0:_themeMode$colors.overlayColor));var getDrawerWrapperStyle=_react.default.useCallback(function(){switch(position){case'left':return{justifyContent:'center',alignItems:'flex-start'};case'right':return{justifyContent:'center',alignItems:'flex-end'};case'top':return{justifyContent:'flex-start',alignItems:'center'};case'bottom':default:return{justifyContent:'flex-end',alignItems:'center'};}},[position]);var getRadiusStyle=_react.default.useCallback(function(){switch(position){case'left':return{borderTopRightRadius:borderRadius,borderBottomRightRadius:borderRadius};case'right':return{borderTopLeftRadius:borderRadius,borderBottomLeftRadius:borderRadius};case'top':return{borderBottomLeftRadius:borderRadius,borderBottomRightRadius:borderRadius};case'bottom':return{borderTopRightRadius:borderRadius,borderTopLeftRadius:borderRadius};default:return{borderRadius:borderRadius};}},[position]);var drawerTransformStyle=mode==='drawer'?getInitialOffset().axis==='x'?{transform:[{translateX:drawerTranslate}],height:"100%",paddingTop:60,maxWidth:"100%",minWidth:"60%"}:{transform:[{translateY:drawerTranslate}],width:"100%",maxHeight:"90%",paddingTop:position==="top"?60:0}:null;return(0,_jsxRuntime.jsx)(_reactNative.Modal,Object.assign({transparent:true,visible:visible,animationType:"fade",onRequestClose:onClose},rest,{children:(0,_jsxRuntime.jsxs)(_reactNative.View,{style:styles.root,children:[(0,_jsxRuntime.jsx)(_reactNative.Animated.View,{style:[styles.overlay,{backgroundColor:resolvedOverlayColor,opacity:overlayOpacity}]}),(0,_jsxRuntime.jsx)(_reactNative.Pressable,{style:styles.overlay,onPress:function onPress(){if(overlayClose)onClose==null||onClose();}}),mode==='drawer'?(0,_jsxRuntime.jsx)(_reactNative.View,{style:[styles.drawerWrapper,getDrawerWrapperStyle()],children:(0,_jsxRuntime.jsxs)(_reactNative.Animated.View,{style:[styles.contentBase,getRadiusStyle(),drawerTransformStyle,style],children:[!hideHeader&&(0,_jsxRuntime.jsxs)(_reactNative.View,{style:[styles.header,headerStyle],children:[(0,_jsxRuntime.jsx)(_Text.default,{style:styles.title,children:title}),(0,_jsxRuntime.jsx)(_reactNative.Pressable,{accessibilityRole:"button",style:styles.closeButton,onPress:onClose,children:(0,_jsxRuntime.jsx)(_Text.default,{children:"\u2715"})})]}),(0,_jsxRuntime.jsx)(_reactNative.View,{style:[{paddingHorizontal:24,paddingVertical:24,paddingTop:0},bodyStyle],children:children})]})}):(0,_jsxRuntime.jsx)(_reactNative.View,{style:styles.centerWrapper,children:(0,_jsxRuntime.jsxs)(_reactNative.View,{style:[styles.contentBase,{borderRadius:borderRadius,width:'100%'},style],children:[!hideHeader&&(0,_jsxRuntime.jsxs)(_reactNative.View,{style:[styles.header,headerStyle],children:[(0,_jsxRuntime.jsx)(_Text.default,{style:styles.title,children:title}),(0,_jsxRuntime.jsx)(_reactNative.Pressable,{accessibilityRole:"button",style:styles.closeButton,onPress:onClose,children:(0,_jsxRuntime.jsx)(_Text.default,{children:"\u2715"})})]}),(0,_jsxRuntime.jsx)(_reactNative.View,{style:[{paddingHorizontal:24,paddingVertical:12,paddingTop:0},bodyStyle],children:children})]})})]})}));};Modal.propTypes=_types.ModalPropTypes;var _default=exports.default=Modal;
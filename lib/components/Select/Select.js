var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));var _objectWithoutProperties2=_interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties"));var _react=_interopRequireWildcard(require("react"));var _reactNative=require("react-native");var _Text=_interopRequireDefault(require("../Text/Text"));var _providers=require("../../providers");var _theme=require("../../theme");var _styles=_interopRequireDefault(require("./styles"));var _types=require("./types");var _Option=_interopRequireDefault(require("./Option"));var _jsxRuntime=require("react/jsx-runtime");var _excluded=["variant","size","borderRadius","leftSection","rightSection","label","error","style","labelStyle","errorStyle","inputStyle","placeholder","placeholderTextColor","onChange","value","data","children"];var _this=this,_jsxFileName="/Users/limonagaci/Desktop/app/dohrnii/src/components/Select/Select.js";function _interopRequireWildcard(e,t){if("function"==typeof WeakMap)var r=new WeakMap(),n=new WeakMap();return(_interopRequireWildcard=function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;var o,i,f={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return f;if(o=t?n:r){if(o.has(e))return o.get(e);o.set(e,f);}for(var _t in e)"default"!==_t&&{}.hasOwnProperty.call(e,_t)&&((i=(o=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,_t))&&(i.get||i.set)?o(f,_t,i):f[_t]=e[_t]);return f;})(e,t);}var defaultCheckSource=require('../../assets/icons/check.png');var defaultChevronSource=require('../../assets/icons/chevron-expand.png');var Select=function Select(props){var _themeMode$colors,_themeMode$colors2,_themeMode$colors$tex;var _useTheme=(0,_providers.useTheme)(),themeMode=_useTheme.theme;var styles=(0,_styles.default)(themeMode);var _SelectDefaultProps$p=Object.assign({},_types.SelectDefaultProps,props),variant=_SelectDefaultProps$p.variant,size=_SelectDefaultProps$p.size,borderRadius=_SelectDefaultProps$p.borderRadius,leftSection=_SelectDefaultProps$p.leftSection,rightSection=_SelectDefaultProps$p.rightSection,label=_SelectDefaultProps$p.label,error=_SelectDefaultProps$p.error,style=_SelectDefaultProps$p.style,labelStyle=_SelectDefaultProps$p.labelStyle,errorStyle=_SelectDefaultProps$p.errorStyle,inputStyle=_SelectDefaultProps$p.inputStyle,placeholder=_SelectDefaultProps$p.placeholder,placeholderTextColor=_SelectDefaultProps$p.placeholderTextColor,onChange=_SelectDefaultProps$p.onChange,value=_SelectDefaultProps$p.value,data=_SelectDefaultProps$p.data,children=_SelectDefaultProps$p.children,rest=(0,_objectWithoutProperties2.default)(_SelectDefaultProps$p,_excluded);var _React$useState=_react.default.useState(false),_React$useState2=(0,_slicedToArray2.default)(_React$useState,2),open=_React$useState2[0],setOpen=_React$useState2[1];var variantStyle=styles.getVariantStyle(variant);var optionsFromChildren=_react.default.Children.toArray(children).filter(function(child){return child&&child.type&&child.type.displayName==='SelectOption';}).map(function(child){return{label:child.props.children,value:child.props.value,disabled:child.props.disabled};});var optionsFromData=Array.isArray(data)?data.map(function(item){return typeof item==='string'?{label:item,value:item}:{label:item.label,value:item.value};}):[];var options=optionsFromChildren.length>0?optionsFromChildren:optionsFromData;var selectedOption=options.find(function(opt){return opt.value===value;});var selectedLabel=selectedOption?selectedOption.label:undefined;var boxStyles=[styles.box,styles[`${size}Box`],{backgroundColor:(0,_theme.processColorValue)(variantStyle.backgroundColor),borderColor:error?(0,_theme.processColorValue)('error.5'):(0,_theme.processColorValue)(variantStyle.borderColor),borderRadius:borderRadius}];var finalPlaceholderColor=placeholderTextColor||(0,_theme.processColorValue)(variantStyle.placeholderColor)||(0,_theme.processColorValue)('text.secondary');var handleSelect=function handleSelect(val){setOpen(false);if(onChange)onChange(val);};var overlayOpacity=(0,_react.useRef)(new _reactNative.Animated.Value(0)).current;(0,_react.useEffect)(function(){if(open){overlayOpacity.setValue(0);_reactNative.Animated.sequence([_reactNative.Animated.delay(200),_reactNative.Animated.timing(overlayOpacity,{toValue:1,duration:250,useNativeDriver:true})]).start();}else{overlayOpacity.setValue(0);}},[open]);return(0,_jsxRuntime.jsxs)(_reactNative.View,Object.assign({style:styles.container},rest,{children:[label?typeof label==='string'?(0,_jsxRuntime.jsx)(_Text.default,{fontWeight:"500",style:[styles.label,labelStyle],children:label}):label:null,(0,_jsxRuntime.jsxs)(_reactNative.TouchableOpacity,{activeOpacity:0.7,onPress:function onPress(){return setOpen(function(prev){return!prev;});},style:[styles.fieldRow,boxStyles],children:[leftSection?(0,_jsxRuntime.jsx)(_reactNative.View,{style:styles.leftSection,children:leftSection}):null,selectedLabel?typeof selectedLabel==='string'?(0,_jsxRuntime.jsx)(_Text.default,{style:[styles.valueText,inputStyle,{color:(0,_theme.processColorValue)(variantStyle.textColor)}],children:selectedLabel}):selectedLabel:placeholder?(0,_jsxRuntime.jsx)(_Text.default,{style:[styles.valueText,inputStyle,{color:finalPlaceholderColor}],children:placeholder}):(0,_jsxRuntime.jsx)(_Text.default,{style:[styles.valueText,inputStyle,{color:finalPlaceholderColor}]}),rightSection?(0,_jsxRuntime.jsx)(_reactNative.View,{style:styles.rightSection,children:rightSection}):(0,_jsxRuntime.jsx)(_reactNative.Image,{source:defaultChevronSource,style:{width:size==='sm'?14:size==='lg'?18:16,height:size==='sm'?14:size==='lg'?18:16,tintColor:themeMode==null||(_themeMode$colors=themeMode.colors)==null?void 0:_themeMode$colors.input[variant].iconColor},resizeMode:"contain"})]}),(0,_jsxRuntime.jsx)(_reactNative.Modal,{visible:open&&options.length>0,transparent:true,animationType:"slide",onRequestClose:function onRequestClose(){return setOpen(false);},children:(0,_jsxRuntime.jsxs)(_reactNative.Pressable,{style:{flex:1,backgroundColor:'transparent',justifyContent:'flex-end'},onPress:function onPress(){return setOpen(false);},children:[(0,_jsxRuntime.jsx)(_reactNative.Animated.View,{pointerEvents:"none",style:{position:'absolute',top:0,left:0,right:0,bottom:0,backgroundColor:themeMode==null||(_themeMode$colors2=themeMode.colors)==null?void 0:_themeMode$colors2.overlayColor,opacity:overlayOpacity}}),(0,_jsxRuntime.jsxs)(_reactNative.Pressable,{style:[styles.dropdown,style],onPress:function onPress(){},children:[label?typeof label==='string'?(0,_jsxRuntime.jsx)(_Text.default,{fontWeight:"500",style:{color:themeMode==null||(_themeMode$colors$tex=themeMode.colors.text)==null?void 0:_themeMode$colors$tex.lightgray,marginLeft:24,marginBottom:5},children:label}):label:null,options.map(function(opt,idx){var _themeMode$colors3;var isSelected=value===opt.value;return(0,_jsxRuntime.jsxs)(_reactNative.TouchableOpacity,{disabled:opt.disabled,onPress:function onPress(){return handleSelect(opt.value);},style:[styles.dropdownItem,isSelected&&styles.dropdownItemActive,opt.disabled&&styles.disabled],children:[typeof opt.label==='string'?(0,_jsxRuntime.jsx)(_Text.default,{style:[styles.dropdownItemText,isSelected&&styles.dropdownItemActiveText],children:opt.label}):opt.label,isSelected&&(0,_jsxRuntime.jsx)(_reactNative.Image,{source:defaultCheckSource,style:{width:16,height:16,tintColor:themeMode==null||(_themeMode$colors3=themeMode.colors)==null||(_themeMode$colors3=_themeMode$colors3.primary)==null?void 0:_themeMode$colors3[5]},resizeMode:"contain"})]},`${String(opt.value)}-${idx}`);})]})]})}),error?(0,_jsxRuntime.jsx)(_Text.default,{size:"xs",style:[styles.errorText,errorStyle],children:error}):null]}));};Select.propTypes=_types.SelectPropTypes;Select.defaultProps=_types.SelectDefaultProps;Select.Option=_Option.default;var _default=exports.default=Select;